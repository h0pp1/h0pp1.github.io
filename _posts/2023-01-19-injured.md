---
title: '[Mobile] InjuredAndroid Writeup-1'
author: hoppi
date: 2023-01-20 00:35:00 + 0000
categories: [Mobile]
tags: [mobile]
---
êµ¬ê¸€ë§ì„ í•˜ë‹¤ê°€ ì¬ë°Œì–´ë³´ì—¬ì„œ í•œë²ˆ í’€ì–´ë´¤ëŠ”ë° ê´œì°®ì€ ì˜ˆì œì¸ ê²ƒ ê°™ë‹¤.  
[ì—¬ê¸°](https://github.com/B3nac/InjuredAndroid)ì„œ ë‹¤ìš´ë°›ì„ ìˆ˜ ìˆë‹¤.  
ì´ 18ê°œì˜ í”Œë ˆê·¸ë¥¼ ì–»ì–´ì•¼ í•˜ë¯€ë¡œ ìƒë‹¹íˆ ë‹¤ ì ìœ¼ë©´ ìƒë‹¹íˆ ê¸¸ì–´ì§ˆ ê²ƒ ê°™ì•„ì„œ 2ê°œë¡œ ë‚˜ëˆ ì„œ ì ìœ¼ë ¤ê³  í•œë‹¤.  
<br/>

# Login
***
ì•„ë˜ì™€ ê°™ì´ í”Œë ˆê·¸ë¥¼ ì…ë ¥í•˜ëŠ” ë¶€ë¶„ì´ ë³´ì¸ë‹¤.  
![one](../../../assets/img/2023-01-19/2023-01-19-one.png){: w="300" h="150" }  
<br/>

`jadx`ë¥¼ ì´ìš©í•˜ì—¬ FlagOneLoginActivtiyë¡œ ê°€ë³´ë©´ `submitFlag()` ë¥¼ ë³¼ ìˆ˜ ìˆë‹¤. if ì¡°ê±´ë¬¸ì—ì„œ ì–´ë–¤ í•¨ìˆ˜ë¥¼ í†µí•´ì„œ ì‚¬ìš©ìì˜ ì…ë ¥ ê°’ê³¼ `F1ag_0n3` ë¬¸ìì—´ì„ ë¹„êµí•˜ëŠ” ê²ƒì²˜ëŸ¼ ë³´ì¸ë‹¤.  
```java
// FlagOneLoginActivtiy: 55

public final void submitFlag(View view) {
        EditText editText = (EditText) findViewById(R.id.editText2);
        d.s.d.g.d(editText, "editText2");
        if (d.s.d.g.a(editText.getText().toString(), "F1ag_0n3")) {
            Intent intent = new Intent(this, FlagOneSuccess.class);
            new FlagsOverview().J(true);
            new j().b(this, "flagOneButtonColor", true);
            startActivity(intent);
        }
    }
```
{: file="FlagOneLoginActivtiy"}
<br/>

ì‹¤ì œë¡œ `d.s.d.g.a()` ë¥¼ ë³´ë©´ obj, obj2 2ê°œì˜ íŒŒë¼ë¯¸í„°ê°€ ê°™ì€ì§€ ë¹„êµí•˜ê³  ê°™ìœ¼ë©´ trueë¥¼ ë°˜í™˜í•œë‹¤. ë”°ë¼ì„œ í”Œë ˆê·¸ëŠ” `F1ag_0n3` ì´ë‹¤.  
```java
// g: 10
public static boolean a(Object obj, Object obj2) {
        return obj == null ? obj2 == null : obj.equals(obj2);
    }
```
{: file="g"}
<br/>

# Exported Activity
***
exportedëœ ë‹¤ë¥¸ ì•¡í‹°ë¹„í‹°ë¥¼ ì‹¤í–‰í•˜ë¼ê³  í•œë‹¤.  
![exported](../../../assets/img/2023-01-19/2023-01-19-exported.png){: w="300" h="150" }  
<br/>

ìš°ì—°ì¹˜ ì•Šê²Œ `b25lActivity`ê°€ flag 2ì™€ ê´€ë ¨ë˜ì–´ìˆëŠ” ê²ƒì„ ì°¾ì•˜ë‹¤.  
```java
package b3nac.injuredandroid;

import android.os.Bundle;

/* loaded from: classes.dex */
public final class b25lActivity extends androidx.appcompat.app.c {
    /* JADX INFO: Access modifiers changed from: protected */
    @Override // androidx.appcompat.app.c, androidx.fragment.app.d, androidx.activity.ComponentActivity, androidx.core.app.e, android.app.Activity
    public void onCreate(Bundle bundle) {
        super.onCreate(bundle);
        setContentView(R.layout.activity_b25l);
        j.j.a(this);
        new FlagsOverview().M(true);
        new j().b(this, "flagTwoButtonColor", true);
    }
}
```
{: file="b25lActivity"}
<br/>

`am` ëª…ë ¹ì–´ë¥¼ í†µí•´ í•´ë‹¹ ì•¡í‹°ë¹„í‹°ë¥¼ ì‹¤í–‰ì‹œì¼œì£¼ë©´ í”Œë ˆê·¸ë¥¼ ì–»ì„ ìˆ˜ ìˆë‹¤.  
```zsh
am start -n b3nac.injuredandroid/b3nac.injuredandroid.b25lActivity
```
<br/>

![two](../../../assets/img/2023-01-19/2023-01-19-two.png){: w="300" h="150" }  
<br/>

# Resources
***
flag 1ê³¼ ë¹„ìŠ·í•˜ì§€ë§Œ ì´ë²ˆì—ëŠ” `R.string.cmVzb3VyY2VzX3lv`ìœ¼ë¡œ  ë¬¸ìì—´ ë¦¬ì†ŒìŠ¤ë¥¼ ì°¸ì¡°í•œë‹¤.  
```java
// FlagThreeActivity: 55

public final void submitFlag(View view) {
        EditText editText = (EditText) findViewById(R.id.editText2);
        d.s.d.g.d(editText, "editText2");
        if (d.s.d.g.a(editText.getText().toString(), getString(R.string.cmVzb3VyY2VzX3lv))) {
            Intent intent = new Intent(this, FlagOneSuccess.class);
            new FlagsOverview().L(true);
            new j().b(this, "flagThreeButtonColor", true);
            startActivity(intent);
        }
    }
```
{: file="FlagThreeActivity"}
<br/>

ë‹¨ìˆœíˆ R í´ë˜ìŠ¤ë¡œ ê°€ì„œ í™•ì¸í•´ë³´ë©´ ì •ìˆ˜í˜•íƒœë¡œ ì €ì¥ë˜ì–´ ìˆì–´ì„œ ë¬¸ìì—´ì„ í™•ì¸í•˜ë ¤ë©´ `res/values/strings.xml`ì„ í™•ì¸í•´ì•¼í•œë‹¤. í”Œë ˆê·¸ëŠ” `F1ag_thr33` ì´ë‹¤.  
![three](../../../assets/img/2023-01-19/2023-01-19-three.png){: w="800" h="400" }  
<br/>

# Login 2
***
FlagFourActivity í´ë˜ìŠ¤ì—ì„œ `submitFlag()`ë¥¼ ë³´ë©´ ë§ˆì°¬ê°€ì§€ë¡œ ì‚¬ìš©ìì˜ ì…ë ¥ê°’ê³¼ `String ìƒì„±ì`ë¥¼ ì´ìš©í•˜ì—¬ ì–´ë–¤ ë¬¸ìì—´ì„ ë¹„êµí•œë‹¤.  
```java
//FlagFourActivity: 53

public final void submitFlag(View view) {
        EditText editText = (EditText) findViewById(R.id.editText2);
        d.s.d.g.d(editText, "editText2");
        String obj = editText.getText().toString();
        byte[] a2 = new g().a();
        d.s.d.g.d(a2, "decoder.getData()");
        if (d.s.d.g.a(obj, new String(a2, d.w.c.f2418a))) {
            Intent intent = new Intent(this, FlagOneSuccess.class);
            new FlagsOverview().I(true);
            new j().b(this, "flagFourButtonColor", true);
            startActivity(intent);
        }
    }
```
{: file="FlagFourActivity"}
<br/>

`String ìƒì„±ì`ì˜ ì²« ë²ˆì§¸ ì¸ì ê°’ì¸ `a2`ëŠ” `g.a()`ì— ì˜í•´ì„œ ìƒì„±ë˜ëŠ” base64 ì¸ì½”ë”© í˜•íƒœì˜ ë¬¸ìì—´ì´ë‹¤.  
```java
package b3nac.injuredandroid;

import android.util.Base64;

/* loaded from: classes.dex */
public class g {

    /* renamed from: a  reason: collision with root package name */
    private byte[] f1468a = Base64.decode("NF9vdmVyZG9uZV9vbWVsZXRz", 0);

    public byte[] a() {
        return this.f1468a;
    }
}
```
{: file="g"}
<br/>

ë‘ ë²ˆì§¸ ì¸ì ê°’ì€ `Charset` íƒ€ì…ìœ¼ë¡œ ì œì¼ ë§ˆì§€ë§‰ì— `ISO-8859-1` ìœ¼ë¡œ ì„¤ì •í•œë‹¤.  
```java
package d.w;

import java.nio.charset.Charset;

/* loaded from: classes.dex */
public final class c {

    /* renamed from: a  reason: collision with root package name */
    public static final Charset f2418a;

    static {
        Charset forName = Charset.forName("UTF-8");
        d.s.d.g.d(forName, "Charset.forName(\"UTF-8\")");
        f2418a = forName;
        d.s.d.g.d(Charset.forName("UTF-16"), "Charset.forName(\"UTF-16\")");
        d.s.d.g.d(Charset.forName("UTF-16BE"), "Charset.forName(\"UTF-16BE\")");
        d.s.d.g.d(Charset.forName("UTF-16LE"), "Charset.forName(\"UTF-16LE\")");
        d.s.d.g.d(Charset.forName("US-ASCII"), "Charset.forName(\"US-ASCII\")");
        d.s.d.g.d(Charset.forName("ISO-8859-1"), "Charset.forName(\"ISO-8859-1\")");
    }
}
```
{: file="c"}
<br/>

íŒŒì´ì¬ìœ¼ë¡œ ë¬¸ìì—´ì„ ë””ì½”ë”© í•´ì£¼ì—ˆë‹¤.  
![four](../../../assets/img/2023-01-19/2023-01-19-four.png){: w="800" h="400" }  
<br/>

# Exported Broadcast Receiver
***
## Broadcast Receiverë€?
***
ë§ ê·¸ëŒ€ë¡œ ë¸Œë¡œë“œìºìŠ¤íŠ¸ë¥¼ ìˆ˜ì‹ í•˜ëŠ” ì—­í• ì„ í•œë‹¤. ì˜ˆë¥¼ ë“¤ì–´ í•¸ë“œí°ì— ì „ì›ì´ ì—°ê²°ë˜ë©´ `ACTION_POWER_CONNECTED` ë¸Œë¡œë“œìºìŠ¤íŠ¸ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ”ë° ë¦¬ì‹œë²„ê°€ ì •ì˜ë˜ì–´ìˆë‹¤ë©´ ì´ì— ë”°ë¥¸ ì–´ë–¤ ë™ì‘ì„ í•  ìˆ˜ ìˆë‹¤.  
## ë¶„ì„
***
ì•„ë˜ì™€ ê°™ì´ FlagFiveActivityì—ì„œ `sendBroadcast()` ë¶€ë¶„ì„ ì°¾ì„ ìˆ˜ ìˆì—ˆê³   
```java
// FlagFiveActivity: 18

public void F() {
        sendBroadcast(new Intent("com.b3nac.injuredandroid.intent.action.CUSTOM_INTENT"));
    }
```
{: file="FlagFiveActivity"}
<br/>

FlagFiveReceiverë¥¼ ë¶„ì„í•´ë³´ë©´ ì—‘í‹°ë¹„í‹°ë¥¼ 3ë²ˆ ë°©ë¬¸í•˜ì—¬ í”Œë ˆê·¸ë¥¼ ì–»ì„ ìˆ˜ ìˆë‹¤.  
```java
public final class FlagFiveReceiver extends BroadcastReceiver {

    /* renamed from: a  reason: collision with root package name */
    private static int f1454a;

    @Override // android.content.BroadcastReceiver
    public void onReceive(Context context, Intent intent) {
        String str;
        int i;
        String e;
        String e2;
        d.s.d.g.e(context, "context");
        d.s.d.g.e(intent, "intent");
        j.j.a(context);
        int i2 = f1454a;
        if (i2 == 0) {
            StringBuilder sb = new StringBuilder();
            e = d.w.h.e("\n    Action: " + intent.getAction() + "\n\n    ");
            sb.append(e);
            e2 = d.w.h.e("\n    URI: " + intent.toUri(1) + "\n\n    ");
            sb.append(e2);
            str = sb.toString();
            d.s.d.g.d(str, "sb.toString()");
            Log.d("DUDE!:", str);
        } else {
            str = "Keep trying!";
            if (i2 != 1) {
                if (i2 != 2) {
                    Toast.makeText(context, "Keep trying!", 1).show();
                    return;
                }
                new FlagsOverview().H(true);
                new j().b(context, "flagFiveButtonColor", true);
                Toast.makeText(context, "You are a winner " + k.a("Zkdlt0WwtLQ="), 1).show();
                i = 0;
                f1454a = i;
            }
        }
        Toast.makeText(context, str, 1).show();
        i = f1454a + 1;
        f1454a = i;
    }
}
```
{: file="FlagFiveReceiver"}
<br/>

![five](../../../assets/img/2023-01-19/2023-01-19-five.png){: w="300" h="150" }  
<br/>

# Login 3
***
ì´ë²ˆì—ëŠ” `k.a()`ë¥¼ í†µí•´ì„œ base64ë¡œ ì¸ì½”ë”©ëœ ë¬¸ìì—´ì„ ë³µí˜¸í™”í•˜ëŠ” ê²ƒ ê°™ë‹¤.
```java
//FlagSixLoginActivity: 57

public final void submitFlag(View view) {
        EditText editText = (EditText) findViewById(R.id.editText3);
        d.s.d.g.d(editText, "editText3");
        if (d.s.d.g.a(editText.getText().toString(), k.a("k3FElEG9lnoWbOateGhj5pX6QsXRNJKh///8Jxi8KXW7iDpk2xRxhQ=="))) {
            Intent intent = new Intent(this, FlagOneSuccess.class);
            FlagsOverview.G = true;
            new j().b(this, "flagSixButtonColor", true);
            startActivity(intent);
        }
    }
```
{: file="FlagSixLoginActivity"}
<br/>

k.a() ì—ì„œ `DES` ë°©ì‹ìœ¼ë¡œ ì•”í˜¸í™”ëœ ë¬¸ìì—´ì„ ë³µí˜¸í™”í•˜ê³  ìˆì—ˆë‹¤. 
```java
public class k {

    /* renamed from: a  reason: collision with root package name */
    private static final byte[] f1472a = h.b();

    /* renamed from: b  reason: collision with root package name */
    private static final byte[] f1473b = h.a();

    public static String a(String str) {
        if (c(str)) {
            try {
                SecretKey generateSecret = SecretKeyFactory.getInstance("DES").generateSecret(new DESKeySpec(f1472a));
                byte[] decode = Base64.decode(str, 0);
                Cipher cipher = Cipher.getInstance("DES");
                cipher.init(2, generateSecret);
                return new String(cipher.doFinal(decode));
            } catch (InvalidKeyException | NoSuchAlgorithmException | InvalidKeySpecException | BadPaddingException | IllegalBlockSizeException | NoSuchPaddingException e) {
                e.printStackTrace();
            }
        } else {
            System.out.println("Not a string!");
        }
        return str;
    }

...

```
{: file="k"}
<br/>

ë³µí˜¸í™”ì— í•„ìš”í•œ keyëŠ” `h.b()`ë¥¼ ì—ì„œ ë‹¨ìˆœíˆ ë¬¸ìì—´ë¡œ ë¦¬í„´ë˜ê³  ìˆë‹¤.  
```java
package b3nac.injuredandroid;

import android.util.Base64;

/* loaded from: classes.dex */
public class h {

    /* renamed from: a  reason: collision with root package name */
    private static byte[] f1469a = Base64.decode("Q2FwdHVyM1RoMXM=", 0);

    /* renamed from: b  reason: collision with root package name */
    private static byte[] f1470b = Base64.decode("e0NhcHR1cjNUaDFzVG9vfQ==", 0);

    /* renamed from: c  reason: collision with root package name */
    private static String f1471c = "9EEADi^^:?;FC652?5C@:5]7:C632D6:@]4@>^DB=:E6];D@?";

    /* JADX INFO: Access modifiers changed from: package-private */
    public static byte[] a() {
        return f1470b;
    }

    /* JADX INFO: Access modifiers changed from: package-private */
    public static byte[] b() {
        return f1469a;
    }

    /* JADX INFO: Access modifiers changed from: package-private */
    public static String c() {
        return f1471c;
    }
}
```
{: file='h'}
<br/>

`frida`ë¥¼ ì´ìš©í•˜ì—¬ `cipher.doFinal()` ì„ í›„í‚¹í•˜ëŠ” ìŠ¤í¬ë¦½íŠ¸ë¥¼ í†µí•´ì„œ í”Œë ˆê·¸ë¥¼ ì–»ì„ ìˆ˜ ìˆë‹¤.  
```javascript
function hookCipherDoFinal() {
    var c = Java.use('javax.crypto.Cipher');
    var string = Java.use('java.lang.String');


    c.doFinal.overload('[B').implementation = function (arg1) {
        console.log(`\n`)
        console.log(`[+] arg1 => ${arg1}`)
        console.log(`Flag => ${string.$new(this.doFinal(arg1), 'utf-8')}`)

        return this.doFinal(arg1)
    }


}
```
{: file='hook.js'}
<br/>

![six](../../../assets/img/2023-01-19/2023-01-19-six.png){: w="600" h="300" }  
<br/>

# SQLite
***
ì•„ì´ë””ì™€ íŒ¨ìŠ¤ì›Œë“œë¥¼ ì…ë ¥ë°›ê³  ìˆì—ˆê³  jVar ì¸ìŠ¤í„´ìŠ¤ì˜ `c()`ì—ì„œ ì•„ì´ë””ì™€ íŒ¨ìŠ¤ì›Œë“œë¥¼ ê°€ì ¸ì˜¤ëŠ” ê²ƒ ê°™ì•˜ë‹¤.  
```java
//FlagSevenSqliteActivity: 57
public final void submitFlag(View view) {
        EditText editText = (EditText) findViewById(R.id.editText8);
        d.s.d.g.d(editText, "editText8");
        String obj = editText.getText().toString();
        EditText editText2 = (EditText) findViewById(R.id.editText7);
        d.s.d.g.d(editText2, "editText7");
        String obj2 = editText2.getText().toString();
        j jVar = new j();
        String c2 = jVar.c("flagSevenEncrypted", "");
        String c3 = jVar.c("flagSevenPasswordEncrypted", "");
        if (!d.s.d.g.a(obj, c2) || !d.s.d.g.a(obj2, c3)) {
            Toast.makeText(this, "Try again! :D", 0).show();
            return;
        }
        FlagsOverview.H = true;
        j jVar2 = new j();
        Context applicationContext = getApplicationContext();
        d.s.d.g.d(applicationContext, "applicationContext");
        jVar2.b(applicationContext, "flagSevenButtonColor", true);
        F();
    }
```
{: file='FlagSevenSqliteActivity'}
<br/>

fridaë¥¼ ì´ìš©í•˜ì—¬ `jVar.c()`ë¥¼ í›„í‚¹í•˜ë©´ ê¸ˆë°© í¬ë¦¬ë´ì…œì„ ì•Œ ìˆ˜ ìˆë‹¤. -> `S3V3N_11:hunter2`  
ì´ë ‡ê²Œ í’€ë©´ ì¬ë¯¸ê°€ ë°˜ê°ë˜ë‹ˆ ì •ì„ì ìœ¼ë¡œ í’€ì–´ë³´ì.  
<br/>

`onCreate` ë¶€ë¶„ì—ì„œ dbì— ê°’ì„ ë„£ëŠ” ë¶€ë¶„ì„ ë³¼ ìˆ˜ ìˆë‹¤.  
```java
//FlagSevenSqliteActivity: 157

@Override // androidx.appcompat.app.c, androidx.fragment.app.d, androidx.activity.ComponentActivity, androidx.core.app.e, android.app.Activity
    public void onCreate(Bundle bundle) {
        super.onCreate(bundle);
        setContentView(2131427370);
        C((Toolbar) findViewById(i.toolbar));
        j.j.a(this);
        H();
        ((FloatingActionButton) findViewById(i.fab)).setOnClickListener(new a());
        SQLiteDatabase writableDatabase = this.x.getWritableDatabase();
        ContentValues contentValues = new ContentValues();
        contentValues.put("title", Base64.decode("VGhlIGZsYWcgaGFzaCE=", 0));
        contentValues.put("subtitle", Base64.decode("MmFiOTYzOTBjN2RiZTM0MzlkZTc0ZDBjOWIwYjE3Njc=", 0));
        writableDatabase.insert("Thisisatest", null, contentValues);
        contentValues.put("title", Base64.decode("VGhlIGZsYWcgaXMgYWxzbyBhIHBhc3N3b3JkIQ==", 0));
        contentValues.put("subtitle", h.c());
        writableDatabase.insert("Thisisatest", null, contentValues);
    }
```
{: file='FlagSevenSqliteActivity'}
<br/>

`/data/data/b3nac.injuredandroid/databases/` ì— ìˆëŠ” `Thisisatest.db`ë¥¼ ë¡œì»¬ë¡œ ë³µì‚¬í•œ ë’¤ `sqlite3` ëª…ë ¹ì–´ë¥¼ í†µí•´ ì—´ì–´ë³´ì•˜ë‹¤.  
ê·¸ëŸ¬ë©´ ì•„ë˜ì™€ ê°™ì´ `md5`ì™€ `ROT`ìœ¼ë¡œ ì•”í˜¸í™”ëœ ë¬¸ìì—´ë“¤ì´ ë³´ì¸ë‹¤.  
![db](../../../assets/img/2023-01-19/2023-01-19-db.png){: w="800" h="400" }  
<br/>

í•´ì‹œë¥¼ crackstationì—ì„œ ê²€ìƒ‰í•´ë³´ë©´ íŒ¨ìŠ¤ì›Œë“œì— í•´ë‹¹í•˜ëŠ” `hunter2`ì„ì„ ì•Œ ìˆ˜ ìˆë‹¤.  
![md5](../../../assets/img/2023-01-19/2023-01-19-md5.png){: w="800" h="400" }  
<br/>

`9EEADi^^:?;FC652?5C@:5]7:C632D6:@]4@>^DB=:E6];D@?`ëŠ” ROT47ë¡œ ë³µí˜¸í™”í•˜ë‹ˆ `https://injuredandroid.firebaseio.com/sqlite.json`ì˜€ê³  í•´ë‹¹ ê²½ë¡œì—ì„œ ì•„ì´ë””ë¥¼ í™•ì¸í•  ìˆ˜ ìˆì—ˆë‹¤.  
![rot](../../../assets/img/2023-01-19/2023-01-19-rot.png){: w="600" h="300" }  
<br/>

# AWS
***
ëª°ë¼ì„œ ê¹ƒí—ˆë¸Œì—ì„œ ë¡¸ì—…ì„ ë´¤ë‹¤. ê·¼ë° `strings.xml` íŒŒì¼ì—ì„œ ì°¾ìœ¼ë¼ëŠ”ë° IDë‘ SECRETì´ ì§€ì›Œì ¸ ìˆëŠ”ë° ì–´ë–»ê²Œ ì•„ë˜ ì»¤ë§¨ë“œë¥¼ ë– ì˜¬ë ¤ì•¼ í•˜ëŠ” ê±´ì§€ ëª¨ë¥´ê² ë‹¤. ğŸ™ƒ  
```zsh
aws s3 ls s3://injuredandroid --no-sign-request
```
<br/>

# Firebase
***
ìƒì„±ì ë¶€ë¶„ì—ì„œ ì¸ì½”ë”©ëœ ë¬¸ìì—´ì„ ë””ì½”ë”©í•´ë³´ë©´ `flags/` ë¼ê³  ë‚˜ì˜¨ë‹¤.  
```java
//FlagNineFirebaseActivity: 92

public FlagNineFirebaseActivity() {
        byte[] decode = Base64.decode("ZmxhZ3Mv", 0);
        this.y = decode;
        d.s.d.g.d(decode, "decodedDirectory");
        Charset charset = StandardCharsets.UTF_8;
        d.s.d.g.d(charset, "StandardCharsets.UTF_8");
        this.z = new String(decode, charset);
        com.google.firebase.database.f b2 = com.google.firebase.database.f.b();
        d.s.d.g.d(b2, "FirebaseDatabase.getInstance()");
        com.google.firebase.database.d d2 = b2.d();
        d.s.d.g.d(d2, "FirebaseDatabase.getInstance().reference");
        this.A = d2;
        com.google.firebase.database.d h = d2.h(this.z);
        d.s.d.g.d(h, "database.child(refDirectory)");
        this.B = h;
    }
```
{: file='FlagNineFirebaseActivity'}
<br/>

ê·¸ë¦¬ê³  `strings.xml`ì—ì„œ firebase urlì„ ì°¾ì„ ìˆ˜ ìˆì—ˆë‹¤.  
![firebase](../../../assets/img/2023-01-19/2023-01-19-firebase.png){: w="600" h="300" }  
<br/>

ë”°ë¼ì„œ `https://injuredandroid.firebaseio.com/flags` ì—”ë“œí¬ì¸íŠ¸ë¡œ ìƒê°í–ˆì§€ë§Œ íŒíŠ¸ë¥¼ ë³´ë‹ˆ .jsonì„ ì´ìš©í•˜ë¼ê³  ì¨ìˆì–´ì„œ `/flags.json`ìœ¼ë¡œ ìš”ì²­í•˜ë‹ˆ í”Œë ˆê·¸ê°€ ë‚˜ì™”ë‹¤.  
![nine](../../../assets/img/2023-01-19/2023-01-19-nine.png){: w="600" h="300" }  
<br/>

í•˜ì§€ë§Œ `submitFlag` ë©”ì†Œë“œ ë¶€ë¶„ì„ ë³´ë©´ ì•„ë˜ì™€ ê°™ì´ ì…ë ¥ê°’ì„ base64 ë””ì½”ë”©ì„ í•˜ê¸° ë•Œë¬¸ì— í”Œë ˆê·¸ë¥¼ ì¸ì½”ë”©í•˜ì—¬ ì…ë ¥í•´ì•¼í•˜ë¯€ë¡œ ìµœì¢…ì ì¸ ì…ë ¥ê°’ì€ `W25pbmUhX2ZsYWdd`ì´ë‹¤.  
```java
//FlagNineFirebaseActivity: 132

public final void submitFlag(View view) {
        EditText editText = (EditText) findViewById(R.id.editText2);
        d.s.d.g.d(editText, "editText2");
        byte[] decode = Base64.decode(editText.getText().toString(), 0);
        d.s.d.g.d(decode, "decodedPost");
        Charset charset = StandardCharsets.UTF_8;
        d.s.d.g.d(charset, "StandardCharsets.UTF_8");
        this.B.b(new b(new String(decode, charset)));
    }
```
{: file='FlagNineFirebaseActivity'}
<br/>

# Unicode
***
ì´ ë‹¨ê³„ëŠ” í›„í‚¹ì„í•˜ë©´ í”Œë ˆê·¸ë¥¼ ì‰½ê²Œ ì°¾ì„ ìˆ˜ ìˆì—ˆì§€ë§Œ ë¡¸ì—…ì„ ë³´ë‹ˆ ë¬¸ì œê°€ ì¡°ê¸ˆ ë‹¬ë¼ì§„ ê²ƒ ê°™ì•˜ë‹¤.  
ë¡¸ì—…ì—ì„œëŠ” `toUpperCase()` ì—ì„œ ë°œìƒí•˜ëŠ” ì¬ë¯¸ìˆëŠ” ë™ì‘ì„ ì´ìš©í•˜ë¼ê³  í•œë‹¤.  
ì´ ë¬¸ì œì—ì„œ ì…ë ¥ë°›ì€ ì‚¬ìš©ì ì…ë ¥ ê°’(í”Œë ˆê·¸)ë¥¼ ëŒ€ë¬¸ìë¡œ ë°”ê¾¸ëŠ”ë° ì•„ë˜ì™€ ê°™ì´ í„°í‚¤ì–´ `Ä±` ê°€ toUpperCase()ë¥¼ ê±°ì¹˜ë©´ ì˜ë¬¸ ëŒ€ë¬¸ì `I` ë¡œ ë°”ë€ë‹¤.  
![false](../../../assets/img/2023-01-19/2023-01-19-false.png){: w="300" h="150"}  
<br/>
![true](../../../assets/img/2023-01-19/2023-01-19-true.png){: w="300" h="150"}  
<br/>

ì˜ˆì „ì— ì›Œê²Œì„ ë¬¸ì œì—ì„œë„ ë³¸ ì ì´ ìˆëŠ”ë° ì´ ë•ŒëŠ” `Kelvin Sign`(U+212A)ì´ toLowerCase()ë¥¼ ë§Œë‚˜ë©´ì„œ ì†Œë¬¸ì `k`ë¡œ ë°”ë€Œì—ˆë‹¤.  
![k](../../../assets/img/2023-01-19/2023-01-19-k.png){: w="600" h="300" }  
<br/>

toUpperCase() ê²½ìš°ë„ í•´ë³´ë‹ˆ ì˜ ëœë‹¤.  
![i](../../../assets/img/2023-01-19/2023-01-19-i.png){: w="600" h="300" }  
<br/>

Referenceì— ìˆëŠ” ê¸€ì„ ì½ì–´ë³´ë©´ ë” ìì„¸í•˜ê²Œ ì•Œ ìˆ˜ ìˆë‹¤.  

# Reference
- [https://docs.oracle.com/javase/7/docs/api/java/lang/String.html](https://docs.oracle.com/javase/7/docs/api/java/lang/String.html)
- [BroadCast](https://crazykim2.tistory.com/633)
- [https://dev.to/jagracey/hacking-github-s-auth-with-unicode-s-turkish-dotless-i-460n](https://dev.to/jagracey/hacking-github-s-auth-with-unicode-s-turkish-dotless-i-460n)